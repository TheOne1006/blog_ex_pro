"use strict";var ngApp;ngApp=angular.module("theoneApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ui.router","ngGrid","ui.bootstrap","ui.tinymce","ngTagsInput","ngSanitize","ngTouch","angularFileUpload"]);"use strict";angular.module("theoneApp").directive("previewImg",["$window",function(a){var b={support:!!(a.FileReader&&a.CanvasRenderingContext2D),isFile:function(b){return angular.isObject(b)&&b instanceof a.File},isImage:function(a){var b="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return"|jpg|png|jpeg|bmp|gif|".indexOf(b)!==-1}};return{restrict:"A",scope:{mypreview:"="},template:"<canvas/>",link:function(a,c,d){var e=new FileReader;var f=c.find("canvas");var g=a.$eval(d.previewImg);var h=true;if(!b.support){h=false}if(!h){c.empty().html("<img />");f=c.find("img")}a.$watch("mypreview",function(){if(!b.isFile(a.mypreview)){return}if(!b.isImage(a.mypreview)){return}e.onload=i;e.readAsDataURL(a.mypreview)});function i(a){var b=new Image;b.onload=j;b.src=a.target.result}function j(){var a=g.width||this.width/this.height*g.height;var b=g.height||this.height/this.width*g.width;f.attr({width:a,height:b});if(h){f[0].getContext("2d").drawImage(this,0,0,a,b)}else{f.attr({src:angular.element(this).attr("src")})}}}}}]).directive("fileChange",["$parse",function(a){return{restrict:"A",link:function(b,c,d){var e=a(d.fileChange);var f=function(a){b.$apply(function(){e(b,{$event:a,files:a.target.files})})};c[0].addEventListener("change",f,false)}}}]);"use strict";angular.module("theoneApp").config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/");a.state("webcam",{url:"/webcam",views:{"@":{templateUrl:"/angular/views/admin/login/webcam.html"}}})}]);angular.module("theoneApp").factory("webcamService",["$http","$window","$interval",function(a,b,c){var d=b.Webcam,e=[],f,g={width:360,height:280,dest_width:180,dest_height:140,image_format:"jpeg",jpeg_quality:90};var h=function(a){angular.extend(g,a);d.set(g)};var i=function(a){d.attach(a);d.on("live",function(){k()})};var j=function(b,c){return a.post(b,{img:c})};var k=function(){f=c(function(){if(d.container){d.snap(function(a){e.push(a);d.upload(a,"/admin/login/verify/face",l)})}else{f.cancel()}},5e3)};var l=function(a,c){if(a===200&&c){c=JSON.parse(c);if(c.is_login){b.location="/admin"}}};return{readyWebcam:function(a,b){a=a||{};h(a);i(b)},takePhotos:function(){if(!d.container){return}},getWebcam:function(){return d.container}}}]).controller("LoginController",["$scope","$window","$http",function(a,b,c){a.user={name:"",password:"",rember:""};a.loginSubmit=function(){c.post("/admin/login/verify/password",{user:a.user}).success(function(a){console.log(a)})}}]).controller("LoginWebcamController",["$scope","$timeout","$window","webcamService",function(a,b,c,d){a.phListArr=[];b(function(){d.readyWebcam(null,"#photo")},1e3)}]);